(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{29:function(e,t,n){e.exports=n(46)},46:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(21),i=n.n(o),c=n(18),l=n(4),s=(n(34),n(37),n(6)),d=n(2),u=n(11),m={primary:"#1c4265",primaryVariant:Object(u.a)(.15,"#1c4265"),secondary:Object(u.b)(.5,"#1c4265"),secondaryVariant:Object(u.b)(.15,"#1c4265")};function p(){var e=Object(s.a)(["\n  body {\n    margin: 0;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n      sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    background: ",";\n  }\n\n  #root {\n    display: flex;\n    height: 100vh;\n  }\n\n  * {\n    user-select: none;\n  }\n"]);return p=function(){return e},e}var f=Object(d.a)(p(),m.primary),y=n(19),h=n(17),g=n.n(h),b=n(25),x=n(3);function v(){var e=Object(s.a)(["\n    cursor: pointer;\n\n    border-color: ",";\n\n    :hover {\n      border-color: ",";\n    }\n\n    :active {\n      background: ",";\n      border-color: ",";\n    }\n  "]);return v=function(){return e},e}var w=d.c.button.withConfig({displayName:"UIstyle__ButtonBase",componentId:"sc-1m0zbe8-0"})(["all:unset;background:",";margin:5px;text-align:center;border:solid 3px ",";",""],m.secondaryVariant,m.primary,function(e){return e.onClick&&Object(d.b)(v(),m.primaryVariant,m.secondaryVariant,m.primary,m.primaryVariant)}),j=(Object(d.c)(w).withConfig({displayName:"UIstyle__Button",componentId:"sc-1m0zbe8-1"})(["flex:1;border-radius:5px;padding:7px;"]),Object(d.c)(w).withConfig({displayName:"UIstyle__RoundButton",componentId:"sc-1m0zbe8-2"})(["border-radius:100%;flex:unset;overflow:hidden;height:80px;width:80px;@media (orientation:portrait){height:50px;width:50px;}"])),C=d.c.div.withConfig({displayName:"UIstyle__Base",componentId:"sc-1m0zbe8-3"})(["display:flex;justify-content:center;"]),E=Object(d.c)(C).withConfig({displayName:"UIstyle__Row",componentId:"sc-1m0zbe8-4"})([""]),I=Object(d.c)(C).withConfig({displayName:"UIstyle__Column",componentId:"sc-1m0zbe8-5"})(["flex:1;flex-direction:column;"]),O=Object(d.c)(E).withConfig({displayName:"StoryCreatorstyle__Wrapper",componentId:"y7tatx-0"})(["background:",";color:",";flex:1;@media (orientation:portrait){flex-direction:column;}"],m.primary,m.secondary),_=d.c.textarea.withConfig({displayName:"StoryCreatorstyle__TextInput",componentId:"y7tatx-1"})(["all:unset;background:",";padding:10px;border-radius:10px;margin:5px;height:55px;::placeholder{color:","}"],m.primaryVariant,m.secondaryVariant);var k=function(e,t){var n=[],a=t.x-e.x,r=t.y-e.y,o=Math.abs(a),i=Math.abs(r),c=a>0?1:-1,l=r>0?1:-1,s=0;if(o>i)for(var d=e.x,u=e.y;c<0?d>=t.x:d<=t.x;d+=c)n.push({x:d,y:u}),(s+=i)<<1>=o&&(u+=l,s-=o);else for(var m=e.x,p=e.y;l<0?p>=t.y:p<=t.y;p+=l)n.push({x:m,y:p}),(s+=o)<<1>=i&&(m+=c,s-=i);return n},N=d.c.div.withConfig({displayName:"Drawingstyle__Wrapper",componentId:"sc-1w2x71x-0"})(["flex:1;background:",";position:relative;overflow:hidden;margin:5px;border-radius:10px;overflow:hidden;"],m.secondaryVariant),S=d.c.img.withConfig({displayName:"Drawingstyle__DrawingImage",componentId:"sc-1w2x71x-1"})(["width:100%;height:100%;object-fit:contain;position:absolute;top:0;left:0;image-rendering:pixelated;"]),P=d.c.canvas.withConfig({displayName:"Drawingstyle__Canvas",componentId:"sc-1w2x71x-2"})(["cursor:crosshair;width:100%;height:100%;position:absolute;top:0;left:0;opacity:0;touch-action:none;"]),U={height:60,width:80},R=function(e){var t=e.onChange,n=e.dataURL,o=e.onPressEnd,i=Object(a.useState)(),c=Object(x.a)(i,2),l=c[0],s=c[1],d=Object(a.useState)(),u=Object(x.a)(d,2),p=u[0],f=u[1],y=Object(a.useState)(!1),h=Object(x.a)(y,2),g=h[0],b=h[1],v=Object(a.useState)(),w=Object(x.a)(v,2),j=w[0],C=w[1];function E(e){if(l&&p){var n=function(e){if(!p)return{x:0,y:0};var t=p.getBoundingClientRect(),n=t.width,a=t.height,r=t.left,o=t.top,i=U.height/U.width,c=a/n,l=i<c?n/U.width:a/U.height,s={x:r,y:o};return i>c?s.x+=(n-U.width*l)/2:s.y+=(a-U.height*l)/2,{x:Math.floor((e.clientX-s.x)/l),y:Math.floor((e.clientY-s.y)/l)}}(e),a=k(j||n,n),r=!0,o=!1,i=void 0;try{for(var c,s=a[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var d=c.value;l.fillRect(d.x,d.y,1,1)}}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}t(p.toDataURL()),C(n)}}function I(){b(!0)}function O(){b(!1),C(void 0),o()}return Object(a.useEffect)(function(){if(l&&p&&(n||(l.fillStyle=m.secondary,l.fillRect(0,0,p.width,p.height),t(p.toDataURL())),l.fillStyle=m.primary,!g)){var e=new Image;e.onload=function(){return l.drawImage(e,0,0)},e.src=n}},[l,p,n,g,t]),r.a.createElement(N,null,n&&r.a.createElement(S,{src:n}),r.a.createElement(P,{ref:function(e){!e||p||l||(f(e),s(e.getContext("2d")||void 0))},onMouseMove:function(e){g&&E(e)},onTouchMove:function(e){E(e.touches[0])},onTouchStart:function(e){I(),E(e.touches[0])},onMouseDown:function(e){I(),E(e)},onMouseUp:O,onTouchEnd:O,onMouseOut:O,width:U.width,height:U.height}))},L=n(26),V=Object(d.c)(I).withConfig({displayName:"PanelConnectionsstyle__Wrapper",componentId:"sc-1s1v7v3-0"})(["flex-direction:column;margin:10px;display:flex;flex:unset;@media (orientation:portrait){flex-direction:row;}"]),M=Object(d.c)(E).withConfig({displayName:"PanelConnectionsstyle__PanelsWrapper",componentId:"sc-1s1v7v3-1"})(["@media (orientation:portrait){flex-direction:column;}align-items:center;justify-content:center;"]),z=d.c.div.withConfig({displayName:"PanelConnectionsstyle__NewPannelText",componentId:"sc-1s1v7v3-2"})(["margin-top:-22px;font-size:5em;@media (orientation:portrait){font-size:3.8em;}"]);function B(){var e=Object(s.a)(["\n  width: 100%;\n  height: 100%;\n"]);return B=function(){return e},e}var T=Object(d.b)(B()),D=d.c.img.withConfig({displayName:"Thumbnailstyle__ThumbnailImage",componentId:"sc-148q6x5-0"})([""," flex:1;"],T),W=d.c.div.withConfig({displayName:"Thumbnailstyle__Placeholder",componentId:"sc-148q6x5-1"})([""," padding-bottom:75%;background-color:",";"],T,m.secondary),F=function(e){var t=e.src;return t?r.a.createElement(D,{src:t}):r.a.createElement(W,null)},q=function(e){var t=e.currentPanel,n=e.prevPanel,a=e.nextPanels,o=e.onConnectionClick,i=e.onNewPanelClick;return r.a.createElement(V,null,n&&r.a.createElement(M,null,r.a.createElement(j,{onClick:function(){return o(n)}},r.a.createElement(F,{src:n.dataURL}))),!n&&r.a.createElement(M,null,r.a.createElement(j,null)),r.a.createElement(M,null,r.a.createElement(j,null,r.a.createElement(F,{src:t.dataURL}))),r.a.createElement(M,null,a.map(function(e){return r.a.createElement(j,{key:e.id,onClick:function(){return o(e)}},r.a.createElement(F,{src:e.dataURL}))}),Object.keys(Object(L.a)(Array(2-a.length))).map(function(e){return r.a.createElement(j,{key:e,onClick:i},r.a.createElement(z,null,"+"))})))},A={panels:[{id:0,nextIds:[],text:"",dataURL:""}]},H=function(){var e=Object(l.c)().firestore().collection("stories").doc("bVCqYmh0KUlhTBd8GHE8"),t=Object(l.d)(e).data()||A,n=Object(a.useState)(0),o=Object(x.a)(n,2),i=o[0],c=o[1],s=Object(a.useState)(t.panels),d=Object(x.a)(s,2),u=d[0],m=d[1],p=Object(a.useState)(!1),f=Object(x.a)(p,2),h=f[0],v=f[1];if(Object(a.useEffect)(function(){function t(){return(t=Object(b.a)(g.a.mark(function t(){return g.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("upload"),e.update("panels",u);case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}h&&(v(!1),function(){t.apply(this,arguments)}())},[u,e,h]),!t)return r.a.createElement(r.a.Fragment,null,"Story not found");var w=u[i],j=void 0!==w.prevId?u[w.prevId]:void 0,C=w.nextIds.map(function(e){return u[e]});return r.a.createElement(O,null,r.a.createElement(I,null,r.a.createElement(R,{onChange:function(e){var t=u.slice(0);t[i]=Object(y.a)({},t[i],{dataURL:e||""}),m(t)},onPressEnd:function(){v(!0)},dataURL:w.dataURL}),r.a.createElement(_,{onChange:function(e){var t=u.slice(0);t[i]=Object(y.a)({},t[i],{text:e.target.value})},value:w.text,placeholder:"Insert panel text here"}),r.a.createElement(E,null)),r.a.createElement(q,{prevPanel:j,currentPanel:w,nextPanels:C,onConnectionClick:function(e){c(e.id)},onNewPanelClick:function(){}}))},J=Object(d.c)(E).withConfig({displayName:"StoryPlayerstyle__Wrapper",componentId:"sc-10j1xfg-0"})(["width:100%;padding:10px;"]),K=Object(d.c)(I).withConfig({displayName:"StoryPlayerstyle__CurrentPanelColumn",componentId:"sc-10j1xfg-1"})(["flex:2;"]),Y=d.c.div.withConfig({displayName:"StoryPlayerstyle__PanelWrapper",componentId:"sc-10j1xfg-2"})(["margin:10px;border:solid 5px ",";border-radius:10px;overflow:hidden;"],m.primaryVariant),G=d.c.img.withConfig({displayName:"StoryPlayerstyle__PanelImage",componentId:"sc-10j1xfg-3"})(["width:100%;image-rendering:pixelated;display:block;"]),Q=d.c.div.withConfig({displayName:"StoryPlayerstyle__PanelText",componentId:"sc-10j1xfg-4"})(["background:",";padding:10px;color:",";"],m.primaryVariant,m.secondary),X=function(e){var t=e.id,n=Object(a.useState)(0),o=Object(x.a)(n,2),i=o[0],c=o[1],s=Object(l.c)().firestore().collection("stories").doc(t),d=Object(l.d)(s).data();if(!d)return r.a.createElement(r.a.Fragment,null,"Story not found");var u=d.panels[i];return r.a.createElement(J,null,u&&r.a.createElement(K,null,r.a.createElement(Y,null,r.a.createElement(G,{src:u.dataURL,alt:u.text}),r.a.createElement(Q,null,u.text))),r.a.createElement(I,null,u.nextIds&&u.nextIds.map(function(e){return r.a.createElement(Y,{key:e},r.a.createElement(G,{src:d.panels[e].dataURL,alt:d.panels[e].text,onClick:function(){return c(e)}}),r.a.createElement(Q,null,d.panels[e].text))})))},Z={apiKey:"AIzaSyC5mVxaorL_LmNWasC5LNmAC3cmlQ-5vFM",authDomain:"story-maker-85706.firebaseapp.com",databaseURL:"https://story-maker-85706.firebaseio.com",projectId:"story-maker-85706",storageBucket:"story-maker-85706.appspot.com",messagingSenderId:"105986550181",appId:"1:105986550181:web:81ec40d053faad45"},$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat("/story-maker","/").concat(e)},ee=function(){return r.a.createElement(l.a,{firebaseConfig:Z,initPerformance:!0},r.a.createElement(f,null),r.a.createElement(c.a,{path:$()},r.a.createElement(l.b,{fallback:"loading...",traceId:"load-story-status"},r.a.createElement(H,null))),r.a.createElement(c.a,{path:$("story/:id")},function(e){return r.a.createElement(l.b,{fallback:"loading...",traceId:"load-story-status"},r.a.createElement(X,{id:e?e.id:void 0}))}))};i.a.render(r.a.createElement(ee,null),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.bec28e89.chunk.js.map