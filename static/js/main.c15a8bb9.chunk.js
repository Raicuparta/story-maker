(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e,n,t){e.exports=t(43)},43:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(20),i=t.n(o),c=t(2),l=t(8),u=t(5),d=(t(33),t(36),t(15)),s={primary:"#1c4265",primaryVariant:Object(d.a)(.15,"#1c4265"),secondary:Object(d.b)(.5,"#1c4265"),secondaryVariant:Object(d.b)(.15,"#1c4265"),borderRadius:{normal:"0.6rem",small:"0.3rem"},spacing:{normal:"0.6rem",small:"0.3rem"}},m=Object(c.c)(function(e){var n=e.theme;return Object(c.d)(["body{margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background:",";color:",";}#root{display:flex;height:100vh;}*{user-select:none;}"],n.primary,n.secondary)}),p=t(12),f=t(7),b=t.n(f),h=t(14),y=t(3),g=t(4);function v(){var e=Object(g.a)(["\n    cursor: pointer;\n\n    border-color: ",";\n\n    :hover {\n      border-color: ",";\n    }\n\n    :active {\n      background: ",";\n      border-color: ",";\n    }\n  "]);return v=function(){return e},e}function j(){var e=Object(g.a)(["\n  all: unset;\n  background: ",";\n  margin: ",";\n  text-align: center;\n  border: solid 3px ",";\n\n  ","\n"]);return j=function(){return e},e}var x=c.e.button.withConfig({displayName:"UIstyle__ButtonBase",componentId:"sc-1m0zbe8-0"})(function(e){var n=e.theme,t=e.onClick;return Object(c.d)(j(),n.secondaryVariant,n.spacing.small,n.primary,t&&Object(c.d)(v(),n.primaryVariant,n.secondaryVariant,n.primary,n.primaryVariant))}),O=(Object(c.e)(x).withConfig({displayName:"UIstyle__Button",componentId:"sc-1m0zbe8-1"})(["flex:1;border-radius:#{theme.borderRadius.small}padding:7px;"]),Object(c.e)(x).withConfig({displayName:"UIstyle__RoundButton",componentId:"sc-1m0zbe8-2"})(["border-radius:100%;flex:unset;overflow:hidden;height:80px;width:80px;@media (orientation:portrait){height:50px;width:50px;}"])),w=c.e.div.withConfig({displayName:"UIstyle__Base",componentId:"sc-1m0zbe8-3"})(["display:flex;justify-content:center;"]),E=Object(c.e)(w).withConfig({displayName:"UIstyle__Row",componentId:"sc-1m0zbe8-4"})([""]),I=Object(c.e)(w).withConfig({displayName:"UIstyle__Column",componentId:"sc-1m0zbe8-5"})(["flex:1;flex-direction:column;"]);function C(){var e=Object(g.a)(["\n  all: unset;\n  background: ",";\n  padding: ",";\n  border-radius: #{theme.borderRadius.normal}\n  margin: ",";\n  height: 55px;\n\n  ::placeholder {\n    color: ","\n  }\n"]);return C=function(){return e},e}function _(){var e=Object(g.a)(["\n  background: ",";\n  flex: 1;\n\n  @media (orientation:portrait) {\n    flex-direction: column;\n  }\n"]);return _=function(){return e},e}var k=Object(c.e)(E).withConfig({displayName:"Editstyle__Wrapper",componentId:"sc-17aii1m-0"})(function(e){var n=e.theme;return Object(c.d)(_(),n.primary)}),N=c.e.textarea.withConfig({displayName:"Editstyle__TextInput",componentId:"sc-17aii1m-1"})(function(e){var n=e.theme;return Object(c.d)(C(),n.primaryVariant,n.spacing.normal,n.spacing.small,n.secondaryVariant)});var R=function(e,n){var t=[],a=n.x-e.x,r=n.y-e.y,o=Math.abs(a),i=Math.abs(r),c=a>0?1:-1,l=r>0?1:-1,u=0;if(o>i)for(var d=e.x,s=e.y;c<0?d>=n.x:d<=n.x;d+=c)t.push({x:d,y:s}),(u+=i)<<1>=o&&(s+=l,u-=o);else for(var m=e.x,p=e.y;l<0?p>=n.y:p<=n.y;p+=l)t.push({x:m,y:p}),(u+=o)<<1>=i&&(m+=c,u-=i);return t};function P(){var e=Object(g.a)(["\n  flex: 1;\n  background: ",";\n  position: relative;\n  overflow: hidden;\n  margin: ",";\n  border-radius: #{theme.borderRadius.normal}\n  overflow: hidden;\n"]);return P=function(){return e},e}var U=c.e.div.withConfig({displayName:"Drawingstyle__Wrapper",componentId:"sc-1uo5c3e-0"})(function(e){var n=e.theme;return Object(c.d)(P(),n.secondaryVariant,n.spacing.small)}),S=c.e.img.withConfig({displayName:"Drawingstyle__DrawingImage",componentId:"sc-1uo5c3e-1"})(["width:100%;height:100%;object-fit:contain;position:absolute;top:0;left:0;image-rendering:pixelated;"]),L=c.e.canvas.withConfig({displayName:"Drawingstyle__Canvas",componentId:"sc-1uo5c3e-2"})(["cursor:crosshair;width:100%;height:100%;position:absolute;top:0;left:0;opacity:0;touch-action:none;"]),V={height:60,width:80},M=function(e){var n=e.onChange,t=e.dataURL,o=e.onPressEnd,i=Object(a.useState)(),l=Object(y.a)(i,2),u=l[0],d=l[1],s=Object(a.useState)(),m=Object(y.a)(s,2),p=m[0],f=m[1],b=Object(a.useState)(!1),h=Object(y.a)(b,2),g=h[0],v=h[1],j=Object(a.useState)(),x=Object(y.a)(j,2),O=x[0],w=x[1],E=Object(a.useContext)(c.a);function I(e){if(u&&p){var t=function(e){if(!p)return{x:0,y:0};var n=p.getBoundingClientRect(),t=n.width,a=n.height,r=n.left,o=n.top,i=V.height/V.width,c=a/t,l=i<c?t/V.width:a/V.height,u={x:r,y:o};return i>c?u.x+=(t-V.width*l)/2:u.y+=(a-V.height*l)/2,{x:Math.floor((e.clientX-u.x)/l),y:Math.floor((e.clientY-u.y)/l)}}(e),a=R(O||t,t),r=!0,o=!1,i=void 0;try{for(var c,l=a[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var d=c.value;u.fillRect(d.x,d.y,1,1)}}catch(s){o=!0,i=s}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}n(p.toDataURL()),w(t)}}function C(){v(!0)}function _(){v(!1),w(void 0),o()}return Object(a.useEffect)(function(){if(u&&p&&(t||(u.fillStyle=E.secondary,u.fillRect(0,0,p.width,p.height),n(p.toDataURL())),u.fillStyle=E.primary,!g)){var e=new Image;e.onload=function(){return u.drawImage(e,0,0)},e.src=t}},[u,p,t,g,n,E]),r.a.createElement(U,null,t&&r.a.createElement(S,{src:t}),r.a.createElement(L,{ref:function(e){!e||p||u||(f(e),d(e.getContext("2d")||void 0))},onMouseMove:function(e){g&&I(e)},onTouchMove:function(e){I(e.touches[0])},onTouchStart:function(e){C(),I(e.touches[0])},onMouseDown:function(e){C(),I(e)},onMouseUp:_,onTouchEnd:_,onMouseOut:_,width:V.width,height:V.height}))},z=t(25);function T(){var e=Object(g.a)(["\n  flex-direction: column;\n  margin: ",";\n  display: flex;\n  flex: unset;\n\n  @media (orientation:portrait) {\n    flex-direction: row;\n  }\n"]);return T=function(){return e},e}var B=Object(c.e)(I).withConfig({displayName:"PanelConnectionsstyle__Wrapper",componentId:"sc-1jlvqvo-0"})(function(e){var n=e.theme;return Object(c.d)(T(),n.spacing.normal)}),D=Object(c.e)(E).withConfig({displayName:"PanelConnectionsstyle__PanelsWrapper",componentId:"sc-1jlvqvo-1"})(["@media (orientation:portrait){flex-direction:column;}align-items:center;justify-content:center;"]),W=c.e.div.withConfig({displayName:"PanelConnectionsstyle__NewPannelText",componentId:"sc-1jlvqvo-2"})(["margin-top:-22px;font-size:5em;@media (orientation:portrait){font-size:3.8em;}"]);function F(){var e=Object(g.a)(["\n  ","\n  padding-bottom: 75%;\n  background-color: ",";\n"]);return F=function(){return e},e}function q(){var e=Object(g.a)(["\n  width: 100%;\n  /* height: 100%; */\n"]);return q=function(){return e},e}var A=Object(c.d)(q()),J=c.e.img.withConfig({displayName:"Thumbnailstyle__ThumbnailImage",componentId:"sc-148q6x5-0"})([""," flex:1;object-fit:contain;image-rendering:pixelated;"],A),H=c.e.div.withConfig({displayName:"Thumbnailstyle__Placeholder",componentId:"sc-148q6x5-1"})(function(e){var n=e.theme;return Object(c.d)(F(),A,n.secondary)}),K=function(e){var n=e.src,t=Object(a.useState)(!1),o=Object(y.a)(t,2),i=o[0],c=o[1];return n&&!i?r.a.createElement(J,{src:n,onError:function(){c(!0)}}):r.a.createElement(H,null)},Q=function(e){var n=e.currentPanel,t=e.prevPanel,a=e.nextPanels,o=e.onConnectionClick,i=e.onNewPanelClick;return r.a.createElement(B,null,t&&r.a.createElement(D,null,r.a.createElement(O,{onClick:function(){return o(t)}},r.a.createElement(K,{src:t.dataURL}))),!t&&r.a.createElement(D,null,r.a.createElement(O,null)),r.a.createElement(D,null,r.a.createElement(O,null,r.a.createElement(K,{src:n.dataURL}))),r.a.createElement(D,null,a.map(function(e){return r.a.createElement(O,{key:e.id,onClick:function(){return o(e)}},r.a.createElement(K,{src:e.dataURL}))}),Object.keys(Object(z.a)(Array(2-a.length))).map(function(e){return r.a.createElement(O,{key:e,onClick:i},r.a.createElement(W,null,"+"))})))},X=function(e){var n=e.id,t=Object(u.c)().firestore().collection("stories").doc(n),o=Object(u.e)(t).data()||{title:"",panels:[{id:0,nextIds:[],text:"",dataURL:""}],id:n},i=Object(a.useState)(0),c=Object(y.a)(i,2),l=c[0],d=c[1],s=Object(a.useState)(o.panels),m=Object(y.a)(s,2),f=m[0],g=m[1],v=Object(a.useState)(!1),j=Object(y.a)(v,2),x=j[0],O=j[1];if(Object(a.useEffect)(function(){function e(){return(e=Object(h.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.update("panels",f);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}x&&(O(!1),function(){e.apply(this,arguments)}())},[f,t,x]),!o)return r.a.createElement(r.a.Fragment,null,"Story not found");var w=f[l],E=void 0!==w.prevId?f[w.prevId]:void 0,C=w.nextIds.map(function(e){return f[e]});return r.a.createElement(k,null,r.a.createElement(I,null,r.a.createElement(M,{onChange:function(e){var n=f.slice(0);n[l]=Object(p.a)({},n[l],{dataURL:e||""}),g(n)},onPressEnd:function(){O(!0)},dataURL:w.dataURL}),r.a.createElement(N,{onChange:function(e){var n=f.slice(0);n[l]=Object(p.a)({},n[l],{text:e.target.value}),g(n)},value:w.text,placeholder:"Insert panel text here"})),r.a.createElement(Q,{prevPanel:E,currentPanel:w,nextPanels:C,onConnectionClick:function(e){d(e.id)},onNewPanelClick:function(){g(function(e){var n=e.slice(0);return n[l].nextIds.push(n.length),n.push({dataURL:"",id:n.length,nextIds:[],prevId:l,text:""}),n})}}))};function Y(){var e=Object(g.a)(["\n  background: ",";\n  padding: ",";\n"]);return Y=function(){return e},e}function G(){var e=Object(g.a)(["\n  margin: ",";\n  border: solid 5px ",";\n  border-radius: #{theme.borderRadius.normal}\n  overflow: hidden;\n"]);return G=function(){return e},e}function Z(){var e=Object(g.a)(["\n  width: 100%;\n  padding: ",";\n"]);return Z=function(){return e},e}var $=Object(c.e)(E).withConfig({displayName:"Playstyle__Wrapper",componentId:"sc-11vgva9-0"})(function(e){var n=e.theme;return Object(c.d)(Z(),n.spacing.normal)}),ee=Object(c.e)(I).withConfig({displayName:"Playstyle__CurrentPanelColumn",componentId:"sc-11vgva9-1"})(["flex:2;"]),ne=c.e.div.withConfig({displayName:"Playstyle__PanelWrapper",componentId:"sc-11vgva9-2"})(function(e){var n=e.theme;return Object(c.d)(G(),n.spacing.normal,n.primaryVariant)}),te=c.e.img.withConfig({displayName:"Playstyle__PanelImage",componentId:"sc-11vgva9-3"})(["width:100%;image-rendering:pixelated;display:block;"]),ae=c.e.div.withConfig({displayName:"Playstyle__PanelText",componentId:"sc-11vgva9-4"})(function(e){var n=e.theme;return Object(c.d)(Y(),n.primaryVariant,n.spacing.normal)}),re=function(e){var n=e.id,t=Object(a.useState)(0),o=Object(y.a)(t,2),i=o[0],c=o[1],l=Object(u.c)().firestore().collection("stories").doc(n),d=Object(u.e)(l).data();if(!d)return r.a.createElement(r.a.Fragment,null,"Story not found");var s=d.panels[i];return r.a.createElement($,null,s&&r.a.createElement(ee,null,r.a.createElement(ne,null,r.a.createElement(te,{src:s.dataURL,alt:s.text}),r.a.createElement(ae,null,s.text))),r.a.createElement(I,null,s.nextIds&&s.nextIds.map(function(e){return r.a.createElement(ne,{key:e},r.a.createElement(te,{src:d.panels[e].dataURL,alt:d.panels[e].text,onClick:function(){return c(e)}}),r.a.createElement(ae,null,d.panels[e].text))})))};function oe(){var e=Object(g.a)(["\n  width: 16rem;\n  height: 12rem;\n  border-radius: ",";\n  overflow: hidden;\n  margin-top: ",";\n"]);return oe=function(){return e},e}function ie(){var e=Object(g.a)(["\n  padding-bottom: 75%;\n  background-color: ",";\n"]);return ie=function(){return e},e}function ce(){var e=Object(g.a)(["\n  margin: ",";\n  font-size: 1.5em;\n  background: ",";\n  padding: ",";\n  border-radius: ",";\n  text-align: center;\n"]);return ce=function(){return e},e}var le=c.e.div.withConfig({displayName:"Liststyle__Story",componentId:"sc-12wt55v-0"})(function(e){var n=e.theme;return Object(c.d)(ce(),n.spacing.normal,n.primaryVariant,n.spacing.normal,n.borderRadius.normal)}),ue=Object(c.e)(E).withConfig({displayName:"Liststyle__StoryList",componentId:"sc-12wt55v-1"})(["flex-wrap:wrap;"]),de=(c.e.div.withConfig({displayName:"Liststyle__Placeholder",componentId:"sc-12wt55v-2"})(function(e){var n=e.theme;return Object(c.d)(ie(),n.secondary)}),c.e.div.withConfig({displayName:"Liststyle__ThumbnailWrapper",componentId:"sc-12wt55v-3"})(function(e){var n=e.theme;return Object(c.d)(oe(),n.borderRadius.small,n.spacing.normal)})),se=function(){var e=Object(u.c)(),n=Object(l.b)(),t=Object(y.a)(n,2)[1],a=e.firestore().collection("stories"),o=Object(u.d)(a).docs.map(function(e){return Object(p.a)({},e.data(),{id:e.id})});if(!o)return r.a.createElement(r.a.Fragment,null,"Stories not found");function i(){return(i=Object(h.a)(b.a.mark(function e(){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={panels:[{id:0,nextIds:[],text:"",dataURL:""}]},e.next=3,a.add(n);case 3:r=e.sent,t("story/".concat(r.id,"/edit"));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}return r.a.createElement("div",null,r.a.createElement(ue,null,o.map(function(e){return r.a.createElement(le,{key:e.id,onClick:function(){return t("story/".concat(e.id))}},e.panels[0].text||"Untitled",r.a.createElement(de,null,r.a.createElement(K,{src:e.panels[0].dataURL})))})),r.a.createElement("button",{onClick:function(){return i.apply(this,arguments)}},"New Story"))},me={apiKey:"AIzaSyC5mVxaorL_LmNWasC5LNmAC3cmlQ-5vFM",authDomain:"story-maker-85706.firebaseapp.com",databaseURL:"https://story-maker-85706.firebaseio.com",projectId:"story-maker-85706",storageBucket:"story-maker-85706.appspot.com",messagingSenderId:"105986550181",appId:"1:105986550181:web:81ec40d053faad45"},pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat("/story-maker","/").concat(e)},fe=function(){return r.a.createElement(c.b,{theme:s},r.a.createElement(u.a,{firebaseConfig:me,initPerformance:!0},r.a.createElement(m,null),r.a.createElement(l.a,{path:pe()},r.a.createElement(u.b,{fallback:"loading...",traceId:"load-story-creaor"},r.a.createElement(se,null))),r.a.createElement(l.a,{path:pe("story/:id")},function(e){return r.a.createElement(u.b,{fallback:"loading...",traceId:"load-story-creaor"},r.a.createElement(re,{id:e?e.id:void 0}))}),r.a.createElement(l.a,{path:pe("story/:id/edit")},function(e){return r.a.createElement(u.b,{fallback:"loading...",traceId:"load-story-player"},r.a.createElement(X,{id:e?e.id:void 0}))})))};i.a.render(r.a.createElement(fe,null),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.c15a8bb9.chunk.js.map