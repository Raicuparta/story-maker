{"version":3,"sources":["components/App/App.style.ts","components/UI/UI.style.ts","components/Edit/Edit.style.ts","components/Edit/Drawing/bresenham.ts","components/Edit/Drawing/Drawing.style.ts","components/Edit/Drawing/Drawing.tsx","components/Edit/Drawing/index.ts","components/Edit/PanelConnections/PanelConnections.style.ts","components/Thumbnail/Thumbnail.style.ts","components/Thumbnail/index.ts","components/Thumbnail/Thumbnail.tsx","components/Edit/PanelConnections/index.ts","components/Edit/PanelConnections/PanelConnections.tsx","components/Edit/Edit.tsx","components/Play/Play.style.ts","components/Play/index.ts","components/Play/Play.tsx","components/List/List.style.ts","components/List/index.ts","components/List/List.tsx","components/App/App.tsx","components/App/index.ts","index.tsx"],"names":["theme","primary","primaryVariant","darken","secondary","lighten","secondaryVariant","borderRadius","normal","small","spacing","GlobalStyle","createGlobalStyle","_ref","css","ButtonBase","styled","button","withConfig","displayName","componentId","onClick","_templateObject","_templateObject2","RoundButton","Base","div","Row","Column","Wrapper","Edit_style_templateObject","TextInput","textarea","_ref2","Edit_style_templateObject2","bresenham","pointA","pointB","points","deltaX","x","deltaY","y","absDeltaY","Math","abs","absDeltaX","signX","signY","eps","push","Drawing_style_templateObject","DrawingImage","img","Canvas","canvas","viewBoxSize","height","width","Drawing","onChange","dataURL","onPressEnd","_useState","useState","_useState2","Object","slicedToArray","context","setContext","_useState3","_useState4","setCanvas","_useState5","_useState6","isDrawing","setIsDrawing","_useState7","_useState8","prevPosition","setPrevPosition","useContext","ThemeContext","draw","event","position","_canvas$getBoundingCl","getBoundingClientRect","left","top","viewBoxRatio","boundsRatio","scale","offset","floor","clientX","clientY","relativePoint","line","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","point","value","fillRect","err","return","toDataURL","startDrawing","stopDrawing","useEffect","fillStyle","image","Image","onload","drawImage","src","react_default","a","createElement","Drawing_style_Wrapper","ref","instance","getContext","onMouseMove","mouseEvent","onTouchMove","touchEvent","touches","onTouchStart","onMouseDown","onMouseUp","onTouchEnd","onMouseOut","PanelConnections_style_templateObject","PanelsWrapper","NewPannelText","common","Thumbnail_style_templateObject","ThumbnailImage","Placeholder","Thumbnail_style_templateObject2","Thumbnail","isImageFailed","setIsImageFailed","onError","PanelConnections","currentPanel","prevPanel","nextPanels","onConnectionClick","onNewPanelClick","PanelConnections_style_Wrapper","components_Thumbnail","map","panel","key","id","keys","toConsumableArray","Array","length","Edit","storyRef","useFirebaseApp","firestore","collection","doc","story","useFirestoreDoc","data","title","panels","nextIds","text","selected","setSelected","setPanels","shouldUpload","setShouldUpload","_updateStory","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","update","stop","apply","this","arguments","updateStory","Fragment","prevId","Edit_Drawing","newPanels","slice","objectSpread","target","placeholder","Edit_PanelConnections","prevPanels","Play_style_templateObject","CurrentPanelColumn","PanelWrapper","Play_style_templateObject2","PanelImage","PanelText","_ref3","_templateObject3","Play","current","setCurrent","Play_style_Wrapper","alt","Story","List_style_templateObject","StoryList","ThumbnailWrapper","List_style_templateObject2","List_style_templateObject3","List","firebaseApp","_useLocation","useLocation","setLocation","storiesRef","stories","useFirestoreCollection","docs","_handleNewStoryClick","add","sent","concat","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","path","relativePath","process","App","styled_components_browser_esm","reactfire","initPerformance","wouter","fallback","traceId","components_List","params","components_Play","components_Edit_Edit","ReactDOM","render","components_App","document","getElementById"],"mappings":"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","file":"static/js/main.c15a8bb9.chunk.js","sourcesContent":["import {\r\n  createGlobalStyle,\r\n  css,\r\n  DefaultTheme,\r\n} from 'styled-components/macro'\r\nimport {\r\n  darken,\r\n  lighten,\r\n} from 'polished'\r\n\r\nconst primary = '#1c4265'\r\nconst primaryVariant = darken(0.15, primary)\r\nconst secondary = lighten(0.5, primary)\r\nconst secondaryVariant = lighten(0.15, primary)\r\n\r\nexport const theme: DefaultTheme = {\r\n  primary,\r\n  primaryVariant,\r\n  secondary,\r\n  secondaryVariant,\r\n  borderRadius: {\r\n    normal: '0.6rem',\r\n    small: '0.3rem',\r\n  },\r\n  spacing: {\r\n    normal: '0.6rem',\r\n    small: '0.3rem',\r\n  },\r\n}\r\n\r\nexport const GlobalStyle = createGlobalStyle(({ theme }) => css`\r\n  body {\r\n    margin: 0;\r\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\r\n      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\r\n      sans-serif;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n\r\n    background: ${theme.primary};\r\n    color: ${theme.secondary};\r\n  }\r\n\r\n  #root {\r\n    display: flex;\r\n    height: 100vh;\r\n  }\r\n\r\n  * {\r\n    user-select: none;\r\n  }\r\n`)\r\n","import styled, {\r\n  css,\r\n} from 'styled-components/macro'\r\n\r\nconst ButtonBase = styled.button(({ theme, onClick }) => css`\r\n  all: unset;\r\n  background: ${theme.secondaryVariant};\r\n  margin: ${theme.spacing.small};\r\n  text-align: center;\r\n  border: solid 3px ${theme.primary};\r\n\r\n  ${onClick && css`\r\n    cursor: pointer;\r\n\r\n    border-color: ${theme.primaryVariant};\r\n\r\n    :hover {\r\n      border-color: ${theme.secondaryVariant};\r\n    }\r\n\r\n    :active {\r\n      background: ${theme.primary};\r\n      border-color: ${theme.primaryVariant};\r\n    }\r\n  `}\r\n`)\r\n\r\nexport const Button = styled(ButtonBase)`\r\n  flex: 1;\r\n  border-radius: #{theme.borderRadius.small}\r\n  padding: 7px;\r\n`\r\n\r\nexport const RoundButton = styled(ButtonBase)`\r\n  border-radius: 100%;\r\n  flex: unset;\r\n  overflow: hidden;\r\n  height: 80px;\r\n  width: 80px;\r\n\r\n  @media (orientation:portrait) {\r\n    height: 50px;\r\n    width: 50px;\r\n  }\r\n`\r\n\r\nconst Base = styled.div`\r\n  display: flex;\r\n  justify-content: center;\r\n`\r\n\r\nexport const Row = styled(Base)``\r\n\r\nexport const Column = styled(Base)`\r\n  flex: 1;\r\n  flex-direction: column;\r\n`\r\n","import styled, {\r\n  css,\r\n} from 'styled-components/macro'\r\n\r\nimport { Row } from '../UI'\r\n\r\nexport const Wrapper = styled(Row)(({ theme }) => css`\r\n  background: ${theme.primary};\r\n  flex: 1;\r\n\r\n  @media (orientation:portrait) {\r\n    flex-direction: column;\r\n  }\r\n`)\r\n\r\nexport const TextInput = styled.textarea(({ theme }) => css`\r\n  all: unset;\r\n  background: ${theme.primaryVariant};\r\n  padding: ${theme.spacing.normal};\r\n  border-radius: #{theme.borderRadius.normal}\r\n  margin: ${theme.spacing.small};\r\n  height: 55px;\r\n\r\n  ::placeholder {\r\n    color: ${theme.secondaryVariant}\r\n  }\r\n`)\r\n","function bresenham (pointA: Point, pointB: Point) {\r\n  const points: Point[] = []\r\n  const deltaX = pointB.x - pointA.x\r\n  const deltaY = pointB.y - pointA.y\r\n  const absDeltaY = Math.abs(deltaX)\r\n  const absDeltaX = Math.abs(deltaY)\r\n  const signX = deltaX > 0 ? 1 : -1\r\n  const signY = deltaY > 0 ? 1 : -1\r\n\r\n  let eps = 0\r\n\r\n  if (absDeltaY > absDeltaX) {\r\n    for (let x = pointA.x, y = pointA.y; signX < 0 ? x >= pointB.x : x <= pointB.x; x += signX) {\r\n      points.push({ x, y })\r\n      eps += absDeltaX\r\n      if ((eps << 1) >= absDeltaY) {\r\n        y += signY\r\n        eps -= absDeltaY\r\n      }\r\n    }\r\n  } else {\r\n    for (let x = pointA.x, y = pointA.y; signY < 0 ? y >= pointB.y : y <= pointB.y; y += signY) {\r\n      points.push({ x, y })\r\n      eps += absDeltaY\r\n      if ((eps << 1) >= absDeltaX) {\r\n        x += signX\r\n        eps -= absDeltaX\r\n      }\r\n    }\r\n  }\r\n  return points\r\n}\r\n\r\nexport default bresenham\r\n","import styled, {\r\n  css,\r\n} from 'styled-components/macro'\r\n\r\nexport const Wrapper = styled.div(({ theme }) => css`\r\n  flex: 1;\r\n  background: ${theme.secondaryVariant};\r\n  position: relative;\r\n  overflow: hidden;\r\n  margin: ${theme.spacing.small};\r\n  border-radius: #{theme.borderRadius.normal}\r\n  overflow: hidden;\r\n`)\r\n\r\nexport const DrawingImage = styled.img`\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: contain;\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  image-rendering: pixelated;\r\n`\r\n\r\nexport const Canvas = styled.canvas`\r\n  cursor: crosshair;\r\n  width: 100%;\r\n  height: 100%;\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  opacity: 0;\r\n  touch-action: none;\r\n`\r\n","import React, {\r\n  useEffect,\r\n  useState,\r\n  useContext,\r\n} from 'react'\r\nimport { ThemeContext } from 'styled-components/macro'\r\n\r\nimport bresenham from './bresenham'\r\nimport {\r\n  Canvas,\r\n  DrawingImage,\r\n  Wrapper,\r\n} from './Drawing.style'\r\n\r\nconst viewBoxSize = {\r\n  height: 60,\r\n  width: 80,\r\n}\r\n\r\ninterface Props {\r\n  onChange: (dataURL: string) => void\r\n  dataURL: string\r\n  onPressEnd: () => void\r\n}\r\n\r\nconst Drawing: React.FC<Props> = ({\r\n  onChange,\r\n  dataURL,\r\n  onPressEnd,\r\n}) => {\r\n  const [context, setContext] = useState<CanvasRenderingContext2D>()\r\n  const [canvas, setCanvas] = useState<HTMLCanvasElement>()\r\n  const [isDrawing, setIsDrawing] = useState(false)\r\n  const [prevPosition, setPrevPosition] = useState<Point>()\r\n  const theme = useContext(ThemeContext)\r\n\r\n  useEffect(() => {\r\n    if (!context || !canvas) {\r\n      return\r\n    }\r\n\r\n    if (!dataURL) {\r\n      context.fillStyle = theme.secondary\r\n      context.fillRect(0, 0, canvas.width, canvas.height)\r\n\r\n      onChange(canvas.toDataURL())\r\n    }\r\n    context.fillStyle = theme.primary\r\n\r\n    // When dataURL is updated, we update the canvas with the new image.\r\n    // But only when a new full image is being loaded, not when we are drawing.\r\n    if (!isDrawing) {\r\n      const image = new Image()\r\n      image.onload = () => context.drawImage(image, 0, 0)\r\n      image.src = dataURL\r\n    }\r\n  }, [context, canvas, dataURL, isDrawing, onChange, theme])\r\n\r\n  function relativePoint (event: React.MouseEvent | React.Touch): Point {\r\n    if (!canvas) {\r\n      return { x: 0, y: 0 }\r\n    }\r\n\r\n    const {\r\n      width,\r\n      height,\r\n      left,\r\n      top,\r\n    } = canvas.getBoundingClientRect()\r\n\r\n    const viewBoxRatio = viewBoxSize.height / viewBoxSize.width\r\n    const boundsRatio = height / width\r\n\r\n    const scale = viewBoxRatio < boundsRatio\r\n      ? width / viewBoxSize.width\r\n      : height / viewBoxSize.height\r\n\r\n    const offset: Point = {\r\n      x: left,\r\n      y: top,\r\n    }\r\n\r\n    if (viewBoxRatio > boundsRatio) {\r\n      offset.x += (width - (viewBoxSize.width * scale)) / 2\r\n    } else {\r\n      offset.y += (height - (viewBoxSize.height * scale)) / 2\r\n    }\r\n\r\n    return {\r\n      x: Math.floor((event.clientX - offset.x) / scale),\r\n      y: Math.floor((event.clientY - offset.y) / scale),\r\n    }\r\n  }\r\n\r\n  function setCanvasRef (instance: HTMLCanvasElement | null) {\r\n    if (!instance || canvas || context) { return }\r\n\r\n    setCanvas(instance)\r\n    setContext(instance.getContext('2d') || undefined)\r\n  }\r\n\r\n  function draw (event: React.MouseEvent | React.Touch) {\r\n    if (!context || !canvas) { return }\r\n\r\n    const position: Point = relativePoint(event)\r\n    const line = bresenham(prevPosition || position, position)\r\n\r\n    for (const point of line) {\r\n      context.fillRect(point.x, point.y, 1, 1)\r\n    }\r\n\r\n    onChange(canvas.toDataURL())\r\n\r\n    setPrevPosition(position)\r\n  }\r\n\r\n  function handleMouseMove (mouseEvent: React.MouseEvent) {\r\n    if (isDrawing) {\r\n      draw(mouseEvent)\r\n    }\r\n  }\r\n\r\n  function handleTouchMove (touchEvent: React.TouchEvent) {\r\n    draw(touchEvent.touches[0])\r\n  }\r\n\r\n  function startDrawing () {\r\n    setIsDrawing(true)\r\n  }\r\n\r\n  function stopDrawing () {\r\n    setIsDrawing(false)\r\n    setPrevPosition(undefined)\r\n    onPressEnd()\r\n  }\r\n\r\n  function handleMouseDown (mouseEvent: React.MouseEvent) {\r\n    startDrawing()\r\n    draw(mouseEvent)\r\n  }\r\n\r\n  function handleTouchStart (touchEvent: React.TouchEvent) {\r\n    startDrawing()\r\n    draw(touchEvent.touches[0])\r\n  }\r\n\r\n  return (\r\n    <Wrapper>\r\n      {dataURL && (\r\n        <DrawingImage src={dataURL} />\r\n      )}\r\n      <Canvas\r\n        ref={setCanvasRef}\r\n        onMouseMove={handleMouseMove}\r\n        onTouchMove={handleTouchMove}\r\n        onTouchStart={handleTouchStart}\r\n        onMouseDown={handleMouseDown}\r\n        onMouseUp={stopDrawing}\r\n        onTouchEnd={stopDrawing}\r\n        onMouseOut={stopDrawing}\r\n        width={viewBoxSize.width}\r\n        height={viewBoxSize.height}\r\n      />\r\n    </Wrapper>\r\n  )\r\n}\r\n\r\nexport default Drawing\r\n","import Drawing from './Drawing'\r\nexport default Drawing\r\n","import styled, {\r\n  css,\r\n} from 'styled-components/macro'\r\n\r\nimport { Column, Row } from '../../UI'\r\n\r\nexport const Wrapper = styled(Column)(({ theme }) => css`\r\n  flex-direction: column;\r\n  margin: ${theme.spacing.normal};\r\n  display: flex;\r\n  flex: unset;\r\n\r\n  @media (orientation:portrait) {\r\n    flex-direction: row;\r\n  }\r\n`)\r\n\r\nexport const PanelsWrapper = styled(Row)`\r\n  @media (orientation:portrait) {\r\n    flex-direction: column;\r\n  }\r\n  align-items: center;\r\n  justify-content: center;\r\n`\r\n\r\nexport const NewPannelText = styled.div`\r\n  margin-top: -22px;\r\n  font-size: 5em;\r\n\r\n  @media (orientation:portrait) {\r\n    font-size: 3.8em;\r\n  }\r\n`\r\n","import styled, {\r\n  css,\r\n} from 'styled-components/macro'\r\n\r\nconst common = css`\r\n  width: 100%;\r\n  /* height: 100%; */\r\n`\r\n\r\nexport const ThumbnailImage = styled.img`\r\n  ${common}\r\n  flex: 1;\r\n  object-fit: contain;\r\n  image-rendering: pixelated;\r\n`\r\n\r\nexport const Placeholder = styled.div(({ theme }) => css`\r\n  ${common}\r\n  padding-bottom: 75%;\r\n  background-color: ${theme.secondary};\r\n`)\r\n","import Thumbnail from './Thumbnail'\r\nexport default Thumbnail\r\n","import React, {\r\n  useState,\r\n} from 'react'\r\n\r\nimport {\r\n  Placeholder,\r\n  ThumbnailImage,\r\n} from './Thumbnail.style'\r\n\r\nconst Thumbnail: React.FC<{ src: string }> = ({ src }) => {\r\n  const [isImageFailed, setIsImageFailed] = useState(false)\r\n\r\n  function handleImageError () {\r\n    setIsImageFailed(true)\r\n  }\r\n\r\n  return (\r\n    (src && !isImageFailed) ? (\r\n      <ThumbnailImage src={src} onError={handleImageError}/>\r\n    ) : (\r\n      <Placeholder />\r\n    )\r\n  )\r\n}\r\n\r\nexport default Thumbnail\r\n","import PanelConnections from './PanelConnections'\r\nexport default PanelConnections\r\n","import React from 'react'\r\n\r\nimport {\r\n  NewPannelText,\r\n  PanelsWrapper,\r\n  Wrapper,\r\n} from './PanelConnections.style'\r\n\r\nimport { RoundButton } from '../../UI'\r\nimport Thumbnail from '../../Thumbnail'\r\n\r\nconst MAX_NEXT_PANELS = 2\r\n\r\nconst PanelConnections: React.FC<{\r\n  prevPanel?: Panel\r\n  currentPanel: Panel\r\n  nextPanels: Panel[]\r\n  onConnectionClick: (panel: Panel) => void\r\n  onNewPanelClick: () => void\r\n}> = ({\r\n  currentPanel,\r\n  prevPanel,\r\n  nextPanels,\r\n  onConnectionClick,\r\n  onNewPanelClick,\r\n}) => (\r\n  <Wrapper>\r\n    {prevPanel && (\r\n      <PanelsWrapper>\r\n        <RoundButton onClick={() => onConnectionClick(prevPanel)}>\r\n          <Thumbnail src={prevPanel.dataURL} />\r\n        </RoundButton>\r\n      </PanelsWrapper>\r\n    )}\r\n    {!prevPanel && (\r\n      <PanelsWrapper>\r\n        <RoundButton />\r\n      </PanelsWrapper>\r\n    )}\r\n    <PanelsWrapper>\r\n      <RoundButton>\r\n        <Thumbnail src={currentPanel.dataURL} />\r\n      </RoundButton>\r\n    </PanelsWrapper>\r\n    <PanelsWrapper>\r\n      {nextPanels.map(panel => (\r\n        <RoundButton\r\n          key={panel.id}\r\n          onClick={() => onConnectionClick(panel)}\r\n        >\r\n          <Thumbnail src={panel.dataURL} />\r\n        </RoundButton>\r\n      ))}\r\n      {\r\n        // Generate an array of numbers from 0 to MAX_NEXT_PANELS\r\n        Object.keys([...Array(MAX_NEXT_PANELS - nextPanels.length)])\r\n          .map(panel => (\r\n            <RoundButton\r\n              key={panel}\r\n              onClick={onNewPanelClick}\r\n            >\r\n              <NewPannelText>+</NewPannelText>\r\n            </RoundButton>\r\n          ))\r\n      }\r\n    </PanelsWrapper>\r\n  </Wrapper>\r\n)\r\n\r\nexport default PanelConnections\r\n","import React, {\r\n  useState,\r\n  useEffect,\r\n} from 'react'\r\nimport {\r\n  useFirestoreDoc,\r\n  useFirebaseApp,\r\n} from 'reactfire'\r\n\r\nimport {\r\n  TextInput,\r\n  Wrapper,\r\n} from './Edit.style'\r\nimport Drawing from './Drawing'\r\nimport PanelConnections from './PanelConnections'\r\n\r\nimport {\r\n  Column,\r\n} from '../UI'\r\n\r\ninterface Props {\r\n  id?: string\r\n}\r\n\r\nconst Edit: React.FC<Props> = ({ id }) => {\r\n  const firebaseApp = useFirebaseApp()\r\n\r\n  const storyRef = firebaseApp\r\n    .firestore()\r\n    .collection('stories')\r\n    .doc(id)\r\n\r\n  // Had to specify the DocumentSnapshot type error to a bug in reactfire's typings\r\n  const storyDoc = useFirestoreDoc<firebase.firestore.DocumentSnapshot>(storyRef)\r\n  const story = storyDoc.data() as Story || {\r\n    title: '',\r\n    panels: [{\r\n      id: 0,\r\n      nextIds: [],\r\n      text: '',\r\n      dataURL: '',\r\n    }],\r\n    id,\r\n  }\r\n\r\n  const [selected, setSelected] = useState<number>(0)\r\n  const [panels, setPanels] = useState<Panel[]>(story.panels)\r\n  const [shouldUpload, setShouldUpload] = useState(false)\r\n\r\n  useEffect(() => {\r\n    if (!shouldUpload) {\r\n      return\r\n    }\r\n\r\n    setShouldUpload(false)\r\n\r\n    async function updateStory () {\r\n      storyRef.update('panels', panels)\r\n    }\r\n\r\n    updateStory()\r\n  }, [panels, storyRef, shouldUpload])\r\n\r\n  if (!story) {\r\n    return <>Story not found</>\r\n  }\r\n\r\n  const currentPanel = panels[selected]\r\n  const prevPanel = (currentPanel.prevId !== undefined) ? panels[currentPanel.prevId] : undefined\r\n  const nextPanels = currentPanel.nextIds.map(id => panels[id])\r\n\r\n  function handleTextChange (event: React.ChangeEvent<HTMLTextAreaElement>) {\r\n    const newPanels = panels.slice(0)\r\n    newPanels[selected] = {\r\n      ...newPanels[selected],\r\n      text: event.target.value,\r\n    }\r\n\r\n    setPanels(newPanels)\r\n  }\r\n\r\n  function handleNewPanelClick () {\r\n    setPanels(prevPanels => {\r\n      const newPanels = prevPanels.slice(0)\r\n\r\n      newPanels[selected].nextIds.push(newPanels.length)\r\n      newPanels.push({\r\n        dataURL: '',\r\n        id: newPanels.length,\r\n        nextIds: [],\r\n        prevId: selected,\r\n        text: '',\r\n      })\r\n\r\n      return newPanels\r\n    })\r\n  }\r\n\r\n  function handleCanvasChange (dataURL: string) {\r\n    const newPanels = panels.slice(0)\r\n    newPanels[selected] = {\r\n      ...newPanels[selected],\r\n      dataURL: dataURL || '',\r\n    }\r\n\r\n    setPanels(newPanels)\r\n  }\r\n\r\n  function handlePanelConnectionClick (panel: Panel) {\r\n    setSelected(panel.id)\r\n  }\r\n\r\n  function handlePressEnd () {\r\n    setShouldUpload(true)\r\n  }\r\n\r\n  return (\r\n    <Wrapper>\r\n      <Column>\r\n        <Drawing\r\n          onChange={handleCanvasChange}\r\n          onPressEnd={handlePressEnd}\r\n          dataURL={currentPanel.dataURL}\r\n        />\r\n        <TextInput\r\n          onChange={handleTextChange}\r\n          value={currentPanel.text}\r\n          placeholder=\"Insert panel text here\"\r\n        />\r\n      </Column>\r\n      <PanelConnections\r\n        prevPanel={prevPanel}\r\n        currentPanel={currentPanel}\r\n        nextPanels={nextPanels}\r\n        onConnectionClick={handlePanelConnectionClick}\r\n        onNewPanelClick={handleNewPanelClick}\r\n      />\r\n    </Wrapper>\r\n  )\r\n}\r\n\r\nexport default Edit\r\n","import styled, {\r\n  css,\r\n} from 'styled-components/macro'\r\n\r\nimport {\r\n  Row,\r\n  Column,\r\n} from '../UI'\r\n\r\nexport const Wrapper = styled(Row)(({ theme }) => css`\r\n  width: 100%;\r\n  padding: ${theme.spacing.normal};\r\n`)\r\n\r\nexport const CurrentPanelColumn = styled(Column)`\r\n  flex: 2;\r\n`\r\n\r\nexport const PanelWrapper = styled.div(({ theme }) => css`\r\n  margin: ${theme.spacing.normal};\r\n  border: solid 5px ${theme.primaryVariant};\r\n  border-radius: #{theme.borderRadius.normal}\r\n  overflow: hidden;\r\n`)\r\n\r\nexport const PanelImage = styled.img`\r\n  width: 100%;\r\n  image-rendering: pixelated;\r\n  display: block;\r\n`\r\n\r\nexport const PanelText = styled.div(({ theme }) => css`\r\n  background: ${theme.primaryVariant};\r\n  padding: ${theme.spacing.normal};\r\n`)\r\n","import Play from './Play'\r\nexport default Play\r\n","import React, {\r\n  useState,\r\n} from 'react'\r\nimport {\r\n  useFirestoreDoc,\r\n  useFirebaseApp,\r\n} from 'reactfire'\r\n\r\nimport {\r\n  PanelImage,\r\n  Wrapper,\r\n  PanelWrapper,\r\n  CurrentPanelColumn,\r\n  PanelText,\r\n} from './Play.style'\r\nimport { Column } from '../UI'\r\n\r\ninterface Props {\r\n  id?: string\r\n}\r\n\r\nconst Play: React.FC<Props> = ({ id }) => {\r\n  const [current, setCurrent] = useState<number>(0)\r\n\r\n  const firebaseApp = useFirebaseApp()\r\n  const storyRef = firebaseApp\r\n    .firestore()\r\n    .collection('stories')\r\n    .doc(id)\r\n\r\n  // Had to specify the DocumentSnapshot type error to a bug in reactfire's typings\r\n  const story = useFirestoreDoc<firebase.firestore.DocumentSnapshot>(storyRef)\r\n    .data() as Story | undefined\r\n\r\n  if (!story) {\r\n    return (\r\n      <>Story not found</>\r\n    )\r\n  }\r\n\r\n  const currentPanel = story.panels[current]\r\n\r\n  return (\r\n    <Wrapper>\r\n      {currentPanel && (\r\n        <CurrentPanelColumn>\r\n          <PanelWrapper>\r\n            <PanelImage\r\n              src={currentPanel.dataURL}\r\n              alt={currentPanel.text}\r\n            />\r\n            <PanelText>\r\n              {currentPanel.text}\r\n            </PanelText>\r\n          </PanelWrapper>\r\n        </CurrentPanelColumn>\r\n      )}\r\n      <Column>\r\n        {currentPanel.nextIds && currentPanel.nextIds.map(id => (\r\n          <PanelWrapper key={id}>\r\n            <PanelImage\r\n              src={story.panels[id].dataURL}\r\n              alt={story.panels[id].text}\r\n              onClick={() => setCurrent(id)}\r\n            />\r\n            <PanelText>\r\n              {story.panels[id].text}\r\n            </PanelText>\r\n          </PanelWrapper>\r\n        ))}\r\n      </Column>\r\n    </Wrapper>\r\n  )\r\n}\r\n\r\nexport default Play\r\n","\r\nimport styled, {\r\n  css,\r\n} from 'styled-components/macro'\r\n\r\nimport { Row } from '../UI'\r\n\r\nexport const Story = styled.div(({ theme }) => css`\r\n  margin: ${theme.spacing.normal};\r\n  font-size: 1.5em;\r\n  background: ${theme.primaryVariant};\r\n  padding: ${theme.spacing.normal};\r\n  border-radius: ${theme.borderRadius.normal};\r\n  text-align: center;\r\n`)\r\n\r\nexport const StoryList = styled(Row)`\r\n  flex-wrap: wrap;\r\n`\r\n\r\nexport const Placeholder = styled.div(({ theme }) => css`\r\n  padding-bottom: 75%;\r\n  background-color: ${theme.secondary};\r\n`)\r\n\r\nexport const ThumbnailWrapper = styled.div(({ theme }) => css`\r\n  width: 16rem;\r\n  height: 12rem;\r\n  border-radius: ${theme.borderRadius.small};\r\n  overflow: hidden;\r\n  margin-top: ${theme.spacing.normal};\r\n`)\r\n","import List from './List'\r\nexport default List\r\n","import React from 'react'\r\nimport {\r\n  useFirebaseApp,\r\n  useFirestoreCollection,\r\n} from 'reactfire'\r\nimport { useLocation } from 'wouter'\r\n\r\nimport {\r\n  StoryList,\r\n  Story,\r\n  ThumbnailWrapper,\r\n} from './List.style'\r\n\r\nimport Thumbnail from '../Thumbnail'\r\n\r\nconst List: React.FC = () => {\r\n  const firebaseApp = useFirebaseApp()\r\n  const [, setLocation] = useLocation()\r\n\r\n  const storiesRef = firebaseApp\r\n    .firestore()\r\n    .collection('stories')\r\n\r\n  // Had to specify the QuerySnapshot type error to an error in reactfire's typings\r\n  const storiesCollection = useFirestoreCollection(storiesRef) as firebase.firestore.QuerySnapshot\r\n  const stories = storiesCollection.docs.map(doc => ({\r\n    ...doc.data(),\r\n    id: doc.id,\r\n  })) as Story[]\r\n\r\n  if (!stories) {\r\n    return (\r\n      <>Stories not found</>\r\n    )\r\n  }\r\n\r\n  async function handleNewStoryClick () {\r\n    const story: Story = {\r\n      panels: [{\r\n        id: 0,\r\n        nextIds: [],\r\n        text: '',\r\n        dataURL: '',\r\n      }],\r\n    }\r\n    const storyRef = await storiesRef.add(story)\r\n    setLocation(`story/${storyRef.id}/edit`)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <StoryList>\r\n        {stories.map(story => (\r\n          <Story\r\n            key={story.id}\r\n            onClick={() => setLocation(`story/${story.id}`)}\r\n          >\r\n            {story.panels[0].text || 'Untitled'}\r\n            <ThumbnailWrapper>\r\n              <Thumbnail src={story.panels[0].dataURL} />\r\n            </ThumbnailWrapper>\r\n          </Story>\r\n        ))}\r\n      </StoryList>\r\n      <button onClick={handleNewStoryClick}>New Story</button>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default List\r\n","import React from 'react'\r\nimport { Route } from 'wouter'\r\nimport { ThemeProvider } from 'styled-components/macro'\r\nimport {\r\n  FirebaseAppProvider,\r\n  SuspenseWithPerf,\r\n} from 'reactfire'\r\nimport 'firebase/performance'\r\nimport 'firebase/firestore'\r\n\r\nimport {\r\n  GlobalStyle,\r\n  theme,\r\n} from './App.style'\r\n\r\nimport Edit from '../Edit/Edit'\r\nimport Play from '../Play'\r\nimport List from '../List'\r\n\r\nconst firebaseConfig = {\r\n  apiKey: 'AIzaSyC5mVxaorL_LmNWasC5LNmAC3cmlQ-5vFM',\r\n  authDomain: 'story-maker-85706.firebaseapp.com',\r\n  databaseURL: 'https://story-maker-85706.firebaseio.com',\r\n  projectId: 'story-maker-85706',\r\n  storageBucket: 'story-maker-85706.appspot.com',\r\n  messagingSenderId: '105986550181',\r\n  appId: '1:105986550181:web:81ec40d053faad45',\r\n}\r\n\r\nconst path = (relativePath = '') => `${process.env.PUBLIC_URL}/${relativePath}`\r\n\r\nconst App: React.FC = () => (\r\n  <ThemeProvider theme={theme}>\r\n    <FirebaseAppProvider\r\n      firebaseConfig={firebaseConfig}\r\n      initPerformance\r\n    >\r\n      <GlobalStyle/>\r\n      <Route path={path()}>\r\n        <SuspenseWithPerf\r\n          fallback={'loading...'}\r\n          traceId={'load-story-creaor'}\r\n        >\r\n          <List />\r\n        </SuspenseWithPerf>\r\n      </Route>\r\n      <Route path={path('story/:id')}>\r\n        {params => (\r\n          <SuspenseWithPerf\r\n            fallback={'loading...'}\r\n            traceId={'load-story-creaor'}\r\n          >\r\n            <Play id={params ? params.id : undefined} />\r\n          </SuspenseWithPerf>\r\n        )}\r\n      </Route>\r\n      <Route path={path('story/:id/edit')}>\r\n        {params => (\r\n          <SuspenseWithPerf\r\n            fallback={'loading...'}\r\n            traceId={'load-story-player'}\r\n          >\r\n            <Edit id={params ? params.id : undefined} />\r\n          </SuspenseWithPerf>\r\n        )}\r\n      </Route>\r\n    </FirebaseAppProvider>\r\n  </ThemeProvider>\r\n)\r\n\r\nexport default App\r\n","import App from './App'\r\nexport default App\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport App from './components/App'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'))\r\n"],"sourceRoot":""}